<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Setup Puanlama Sitesi</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(270deg,#0a1f44,#0d47a1,#2196f3);
  background-size:600% 600%;
  animation:bg 14s ease infinite;
  color:white;
  padding-top:70px;
}
@keyframes bg{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* ===== ÜST MESAJ ===== */
#topMsg{
  position:fixed;
  top:-60px;
  left:50%;
  transform:translateX(-50%);
  background:#22c55e;
  padding:14px 28px;
  border-radius:0 0 20px 20px;
  font-weight:bold;
  transition:.6s;
  z-index:999;
}
#topMsg.show{top:0}

/* ===== FORM ===== */
form{
  max-width:520px;
  margin:0 auto 20px;
  background:rgba(0,0,0,.45);
  padding:22px;
  border-radius:20px;
  backdrop-filter:blur(10px);
}
.field{
  margin:18px 0;
}
input,textarea{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:2px solid #64b5f6;
  background:rgba(255,255,255,.08);
  color:white;
  outline:none;
}
input:focus,textarea:focus{
  box-shadow:0 0 16px #64b5f6;
}
button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:16px;
  background:linear-gradient(135deg,#64b5f6,#1976d2);
  color:white;
  font-weight:bold;
  cursor:pointer;
  transition:.3s;
}
button:hover{
  transform:scale(1.08);
  box-shadow:0 0 24px #64b5f6;
}

/* ===== KARTLAR ===== */
.setups{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:16px;
  padding:10px;
}
.card{
  background:rgba(0,0,0,.45);
  border-radius:20px;
  overflow:hidden;
  animation:fade .5s;
}
@keyframes fade{
  from{opacity:0;transform:scale(.9)}
  to{opacity:1}
}
.card img{width:100%}
.card .info{padding:12px}

/* ===== PUAN ===== */
.stars span{
  cursor:pointer;
  font-size:18px;
}
.comment{
  width:100%;
  margin-top:6px;
  padding:8px;
  border-radius:10px;
  border:none;
}
.comments p{
  font-size:13px;
  border-bottom:1px solid rgba(255,255,255,.2);
  padding:4px 0;
}
</style>
</head>

<body>

<div id="topMsg"></div>

<form>
  <input id="name" placeholder="İsmin">
  <textarea id="desc" placeholder="Setup Açıklaması"></textarea>
  <input type="file" id="photo" accept="image/*">
  <button type="button" onclick="addSetup()">Setup Paylaş</button>
</form>

<div class="setups" id="setups"></div>

<script>
const setupsDiv=document.getElementById("setups");
const topMsg=document.getElementById("topMsg");

let setups=JSON.parse(localStorage.getItem("setups")||"[]");
let today=new Date().toDateString();
let daily=JSON.parse(localStorage.getItem("daily")||"{}");

if(daily.date!==today){
  daily={date:today,count:0};
}

function showMsg(text,color="#22c55e"){
  topMsg.textContent=text;
  topMsg.style.background=color;
  topMsg.classList.add("show");
  setTimeout(()=>topMsg.classList.remove("show"),2500);
}

function addSetup(){
  const name=nameInput.value.trim();
  const desc=descInput.value.trim();
  const file=photo.files[0];

  if(!name||!desc||!file){
    showMsg("❗ Boş alan bırakmayın","#ef4444");
    return;
  }
  if(daily.count>=2){
    showMsg("⛔ Günlük maksimum 2 setup paylaşabilirsin","#ef4444");
    return;
  }

  const r=new FileReader();
  r.onload=()=>{
    setups.unshift({
      name,desc,img:r.result,
      ratings:[],comments:[]
    });
    daily.count++;
    localStorage.setItem("setups",JSON.stringify(setups));
    localStorage.setItem("daily",JSON.stringify(daily));
    render();
    showMsg("✅ Setup paylaşıldı");
    document.querySelector("form").reset();
  };
  r.readAsDataURL(file);
}

function rate(i,val){
  setups[i].ratings.push(val);
  save();
}
function comment(i,input){
  if(!input.value.trim()){
    alert("Yorum boş olamaz");
    return;
  }
  setups[i].comments.push(input.value);
  input.value="";
  save();
}
function avg(arr){
  return arr.length
    ? (arr.reduce((a,b)=>a+b,0)/arr.length).toFixed(1)
    : "0";
}
function save(){
  localStorage.setItem("setups",JSON.stringify(setups));
  render();
}

function render(){
  setupsDiv.innerHTML="";
  setups.forEach((s,i)=>{
    setupsDiv.innerHTML+=`
    <div class="card">
      <img src="${s.img}">
      <div class="info">
        <b>${s.name}</b>
        <p>${s.desc}</p>
        <p>⭐ Ortalama: ${avg(s.ratings)}</p>

        <div class="stars">
          ${[1,2,3,4,5].map(n=>`<span onclick="rate(${i},${n})">⭐</span>`).join("")}
        </div>

        <input class="comment" placeholder="Yorum yaz"
          onkeydown="if(event.key==='Enter')comment(${i},this)">
        <div class="comments">
          ${s.comments.map(c=>`<p>${c}</p>`).join("")}
        </div>
      </div>
    </div>`;
  });
}

render();
</script>

</body>
</html>

